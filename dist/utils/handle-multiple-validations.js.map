{"version":3,"file":"handle-multiple-validations.js","sources":["../../src/utils/handle-multiple-validations.js"],"sourcesContent":["import { A as emberArray } from '@ember/array';\nimport { all } from 'rsvp';\nimport { typeOf } from '@ember/utils';\nimport { isPromise } from 'validated-changeset';\n\n/**\n * Rejects `true` values from an array of validations. Returns `true` when there\n * are no errors, or the error object if there are errors.\n *\n * @private\n * @param  {Array} validations\n * @return {Boolean|Any}\n */\nfunction handleValidations(validations = []) {\n  let rejectedValidations = emberArray(validations).reject(\n    (validation) => typeOf(validation) === 'boolean' && validation,\n  );\n\n  return rejectedValidations.length === 0 || rejectedValidations;\n}\n\n/**\n * Handles an array of validators and returns Promise.all if any value is a\n * Promise.\n *\n * @public\n * @param  {Array} validators Array of validator functions\n * @param  {String} options.key\n * @param  {Any} options.newValue\n * @param  {Any} options.oldValue\n * @param  {Object} options.changes\n * @param  {Object} options.content\n * @return {Promise|Boolean|Any}\n */\nexport default function handleMultipleValidations(\n  validators,\n  { key, newValue, oldValue, changes, content },\n) {\n  let validations = emberArray(\n    validators.map((validator) =>\n      validator(key, newValue, oldValue, changes, content),\n    ),\n  );\n\n  if (emberArray(validations).any(isPromise)) {\n    return all(validations).then(handleValidations);\n  }\n\n  return handleValidations(validations);\n}\n"],"names":["handleValidations","validations","rejectedValidations","emberArray","reject","validation","typeOf","length","handleMultipleValidations","validators","key","newValue","oldValue","changes","content","map","validator","any","isPromise","all","then"],"mappings":";;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASA,iBAAiBA,CAACC,WAAW,GAAG,EAAE,EAAE;AAC3C,EAAA,IAAIC,mBAAmB,GAAGC,CAAU,CAACF,WAAW,CAAC,CAACG,MAAM,CACrDC,UAAU,IAAKC,MAAM,CAACD,UAAU,CAAC,KAAK,SAAS,IAAIA,UACtD,CAAC;AAED,EAAA,OAAOH,mBAAmB,CAACK,MAAM,KAAK,CAAC,IAAIL,mBAAmB;AAChE;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACe,SAASM,yBAAyBA,CAC/CC,UAAU,EACV;EAAEC,GAAG;EAAEC,QAAQ;EAAEC,QAAQ;EAAEC,OAAO;AAAEC,EAAAA;AAAQ,CAAC,EAC7C;EACA,IAAIb,WAAW,GAAGE,CAAU,CAC1BM,UAAU,CAACM,GAAG,CAAEC,SAAS,IACvBA,SAAS,CAACN,GAAG,EAAEC,QAAQ,EAAEC,QAAQ,EAAEC,OAAO,EAAEC,OAAO,CACrD,CACF,CAAC;EAED,IAAIX,CAAU,CAACF,WAAW,CAAC,CAACgB,GAAG,CAACC,SAAS,CAAC,EAAE;IAC1C,OAAOC,GAAG,CAAClB,WAAW,CAAC,CAACmB,IAAI,CAACpB,iBAAiB,CAAC;AACjD;EAEA,OAAOA,iBAAiB,CAACC,WAAW,CAAC;AACvC;;;;"}